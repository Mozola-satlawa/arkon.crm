<!doctype html>
<html lang="pl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ARKON — Katalog ocieplenia</title>
<meta name="description" content="Katalog materiałów ociepleniowych: wełna, styropian, pianka, systemy dociepleń, akcesoria. Wspólny storage z komponenty.html.">
<style>
  :root{ --bg:#0b1020; --p1:#121a34; --p2:#172142; --ink:#e8edff; --muted:#aeb8da; --accent:#4cc9f0; --ok:#2b8a57; --bad:#ff6b6b; --grid:#243059; --line:#1c2750; }
  body{margin:0;background:linear-gradient(180deg,#0a0f1e,#0c1230 60%,#0a0f1e);color:var(--ink);font:15px/1.5 system-ui,Segoe UI,Roboto,Arial}
  header{padding:16px;background:#11183a;border-bottom:1px solid var(--line)}
  header h1{margin:0;font-size:22px}
  nav{background:#172142;display:flex;gap:10px;flex-wrap:wrap;padding:10px 16px;border-bottom:1px solid var(--line)}
  nav a{color:#cfe1ff;text-decoration:none;padding:8px 12px;border-radius:999px;border:1px solid #2a3a75}
  nav a:hover{background:#223160}
  .wrap{max-width:1280px;margin:auto;padding:16px}

  .toolbar{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin:10px 0}
  .btn{background:#233261;border:1px solid #3a4ca3;color:#fff;border-radius:10px;padding:8px 12px;cursor:pointer}
  .btn.ghost{background:transparent;border:1px dashed #3a4ca3}
  .btn.ok{background:#194d34;border-color:var(--ok)}
  .btn.bad{background:#3a1f2a;border-color:#7b3341}
  .pill{display:inline-block;background:#0d1530;border:1px dashed #2b3a77;border-radius:999px;padding:6px 10px;color:#aeb8da;font-size:13px}
  .muted{color:var(--muted);font-size:13px}
  input,select{background:#0d1530;border:1px solid #28356c;border-radius:10px;padding:8px 10px;color:var(--ink);font:inherit}
  input::placeholder{color:#aeb8da99}
  .card{background:linear-gradient(180deg,var(--p1),var(--p2));border:1px solid var(--line);border-radius:14px;padding:14px;margin:10px 0}
  table{width:100%;border-collapse:separate;border-spacing:0}
  th,td{padding:8px 10px;border-bottom:1px solid #203063;text-align:left}
  th{font-size:12px;color:#aeb8da}
  td.edit{background:#0d1530;border:1px solid #28356c;border-radius:6px}
  td .cell{min-width:60px}
  .num{text-align:right;font-variant-numeric:tabular-nums}
</style>
</head>
<body>

<header>
  <h1>Katalog komponentów • Ocieplenie</h1>
  <div class="muted">Materiały: wełna mineralna, styropian, pianka PUR, systemy dociepleń, akcesoria. Wspólna baza: <code>arkon_components_v1</code>.</div>
</header>

<nav>
  <a href="index.html">Pulpit</a>
  <a href="komponenty.html">Komponenty</a>
  <a href="komponenty-pompy.html">Pompy</a>
  <a href="komponenty-piece.html">Piece</a>
  <a href="komponenty-fotowoltaika.html">Fotowoltaika</a>
  <a href="komponenty-ocieplenie.html">Ocieplenie</a>
</nav>

<div class="wrap">
  <div class="toolbar">
    <button id="btnAdd" class="btn ok">+ Dodaj materiał</button>
    <button id="btnExport" class="btn ghost">Eksport JSON</button>
    <label class="btn ghost">Import<input id="fileImport" type="file" accept="application/json" hidden></label>
    <span class="pill">Pozycji: <b id="countAll">0</b></span>
  </div>

  <div style="overflow:auto">
    <table id="tbl">
      <thead>
        <tr>
          <th>Akcje</th>
          <th>Nazwa</th>
          <th>Typ</th>
          <th>Marka</th>
          <th>λ [W/mK]</th>
          <th>Grubość [mm]</th>
          <th>Wymiar płyty [mm]</th>
          <th class="num">Cena NETTO</th>
          <th class="num">VAT %</th>
          <th class="num">Cena BRUTTO</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody id="tbody"></tbody>
    </table>
  </div>
</div>

<script>
'use strict';
const $=s=>document.querySelector(s);
const uid=()=>Math.random().toString(36).slice(2)+Date.now().toString(36);
const LS_KEY='arkon_components_v1';
let items=loadItems();

function loadItems(){ try{return JSON.parse(localStorage.getItem(LS_KEY)||'[]');}catch{return[];} }
function saveItems(){ localStorage.setItem(LS_KEY,JSON.stringify(items)); render(); }
function calcGross(n,v){return (Number(n)||0)*(1+(Number(v)||0)/100);}

if(!items.some(x=>/Ocieplenie/.test(x.type||''))){
  items.unshift(
    {id:uid(),name:'Wełna mineralna',type:'Ocieplenie',brand:'Rockwool',lambda:0.035,thk:150,size:'1200x600',net:38,vat:8,status:'OK'},
    {id:uid(),name:'Styropian EPS 70',type:'Ocieplenie',brand:'Austrotherm',lambda:0.040,thk:200,size:'1000x500',net:32,vat:8,status:'OK'},
    {id:uid(),name:'Pianka PUR natryskowa',type:'Ocieplenie',brand:'Purios',lambda:0.025,thk:120,size:'—',net:95,vat:8,status:'ORDER'}
  );
  saveItems();
}

function render(){
  $('#countAll').textContent=items.filter(r=>r.type==='Ocieplenie').length;
  const tb=$('#tbody'); tb.innerHTML='';
  items.filter(r=>r.type==='Ocieplenie').forEach(r=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`
      <td>
        <button class="btn ghost" data-del="${r.id}">Usuń</button>
      </td>
      <td class="edit"><div class="cell" contenteditable data-k="name">${r.name||''}</div></td>
      <td class="edit"><div class="cell" contenteditable data-k="type">${r.type||''}</div></td>
      <td class="edit"><div class="cell" contenteditable data-k="brand">${r.brand||''}</div></td>
      <td class="edit num"><div class="cell" contenteditable data-k="lambda">${r.lambda||''}</div></td>
      <td class="edit num"><div class="cell" contenteditable data-k="thk">${r.thk||''}</div></td>
      <td class="edit"><div class="cell" contenteditable data-k="size">${r.size||''}</div></td>
      <td class="edit num"><div class="cell" contenteditable data-k="net">${r.net||0}</div></td>
      <td class="edit num"><div class="cell" contenteditable data-k="vat">${r.vat||8}</div></td>
      <td class="num">${calcGross(r.net,r.vat).toFixed(2)}</td>
      <td class="edit"><div class="cell" contenteditable data-k="status">${r.status||''}</div></td>`;
    tr.querySelectorAll('[contenteditable]').forEach(el=>{
      el.onblur=()=>saveCell(r.id,el.dataset.k,el.textContent.trim());
      el.onkeydown=e=>{if(e.key==='Enter'){e.preventDefault();el.blur();}};
    });
    tr.querySelector('[data-del]').onclick=()=>{items=items.filter(x=>x.id!==r.id);saveItems();};
    tb.appendChild(tr);
  });
}
function saveCell(id,k,v){
  const it=items.find(x=>x.id===id); if(!it) return;
  if(['net','vat','thk','lambda'].includes(k)) it[k]=parseFloat(v)||0;
  else it[k]=v;
  saveItems();
}
$('#btnAdd').onclick=()=>{
  items.unshift({id:uid(),name:'Nowy materiał',type:'Ocieplenie',brand:'',lambda:0.035,thk:100,size:'',net:0,vat:8,status:'OK'});
  saveItems();
};
$('#btnExport').onclick=()=>{
  const blob=new Blob([JSON.stringify(items.filter(r=>r.type==='Ocieplenie'),null,2)],{type:'application/json'});
  const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='ocieplenie.json';a.click();URL.revokeObjectURL(a.href);
};
$('#fileImport').onchange=async e=>{
  const f=e.target.files[0]; if(!f) return;
  const txt=await f.text(); const data=JSON.parse(txt);
  if(Array.isArray(data)) items=items.concat(data.map(x=>({...x,id:uid(),type:'Ocieplenie'})));
  saveItems(); e.target.value='';
};
render();
</script>
</body>
</html>