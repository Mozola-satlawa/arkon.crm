<!doctype html>
<html lang="pl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ARKON CRM ‚Äî Dokumenty do pobrania (rozbudowane)</title>
<meta name="description" content="Panel dokument√≥w: sprawdzanie dostƒôpno≈õci plik√≥w, grupy, podpowied≈∫ nazw ASCII, szybkie pobieranie.">
<style>
  :root{
    --bg:#0b1020; --grad1:#0a1028; --grad2:#0d1536;
    --ink:#e8edff; --muted:#aeb8da; --line:#22306a;
    --card:#0f1636; --chip:#16245a; --accent:#4cc9f0;
    --ok:#2fbf71; --warn:#ffb84d; --bad:#ff6b6b;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;font:15px/1.55 system-ui,Segoe UI,Roboto,Arial;background:linear-gradient(180deg,var(--grad1),var(--grad2));color:var(--ink)}
  a{color:#cfe0ff;text-decoration:none}
  header{padding:16px;border-bottom:1px solid var(--line);background:#0e1534;position:sticky;top:0;z-index:8}
  header h1{margin:0;font-size:22px}
  nav{display:flex;gap:10px;flex-wrap:wrap;padding:10px 16px;border-bottom:1px solid var(--line);background:#121a44}
  nav a{padding:8px 12px;border-radius:999px;border:1px solid #2a3a75}
  nav a:hover{background:#1a2758}
  .wrap{max-width:1200px;margin:0 auto;padding:16px}
  .card{background:linear-gradient(180deg,#0f1636,#0f1a42);border:1px solid var(--line);border-radius:14px;padding:14px}
  .muted{color:var(--muted);font-size:13px}
  .pill{display:inline-block;background:#0d1530;border:1px dashed #2b3a77;border-radius:999px;padding:6px 10px;color:#aeb8da;font-size:13px}
  .list{list-style:none;margin:0;padding:0}
  .row{display:flex;align-items:center;gap:10px}
  .doc{display:grid;grid-template-columns:24px 1fr auto;gap:10px;align-items:center;padding:10px 8px;border-bottom:1px solid #1a244d}
  .doc:last-child{border-bottom:0}
  .dot{width:12px;height:12px;border-radius:50%}
  .dot.ok{background:#2fbf71;box-shadow:0 0 0 3px #2fbf7133}
  .dot.bad{background:#ff6b6b;box-shadow:0 0 0 3px #ff6b6b33}
  .dot.try{background:#ffb84d;box-shadow:0 0 0 3px #ffb84d33}
  .path{font-size:12px;color:#aeb8da}
  .buttons a,.buttons button{margin-left:8px;background:#233261;border:1px solid #3a4ca3;color:#fff;border-radius:10px;padding:6px 10px;cursor:pointer}
  .buttons button{background:transparent;border-style:dashed}
  .grid{display:grid;gap:12px}
  @media(min-width:980px){ .cols-2{grid-template-columns:2fr 1fr} }
  .tip{background:#101a45;border:1px dashed #2a3a75;border-radius:12px;padding:10px}
  .small{font-size:12px}
  .search{width:100%;background:#0d1530;border:1px solid #28356c;border-radius:10px;padding:10px;color:var(--ink)}
  .grp{margin:8px 0 16px}
  .grp h3{margin:0 0 6px 0;font-size:16px}
  .badge{font-size:11px;border:1px solid #3a4ca3;border-radius:999px;padding:2px 8px;margin-left:8px}
</style>
</head>
<body>
<header>
  <h1>Dokumenty do pobrania</h1>
  <div class="muted">Automatyczna weryfikacja plik√≥w, alternatywne linki (ASCII), szybkie pobieranie.</div>
</header>

<nav aria-label="Nawigacja">
  <a href="index.html">Pulpit</a>
  <a href="kalkulator.html">Kalkulator</a>
  <a href="komponenty.html">Komponenty</a>
  <a href="klienci.html">Klienci</a>
  <a href="lidy.html">Leady</a>
  <a href="chat.html">Komunikator</a>
  <a href="ustawienia.html">Ustawienia</a>
  <a href="dokumenty.html" aria-current="page">Dokumenty</a>
</nav>

<div class="wrap grid cols-2">
  <section class="card">
    <div class="row" style="justify-content:space-between;gap:8px">
      <input id="q" class="search" placeholder="üîé Szukaj po nazwie pliku lub tytule‚Ä¶">
      <span class="pill">Znalezionych: <b id="found">0</b></span>
    </div>

    <div id="list"></div>
  </section>

  <aside class="grid">
    <div class="card tip">
      <b>Je≈ºeli link nie dzia≈Ça</b>
      <ul class="small">
        <li>Hosting czƒôsto nie lubi polskich znak√≥w i spacji w nazwie pliku.</li>
        <li>Spr√≥buj wersji w <b>ASCII</b> ‚Äî podajemy gotowy alternatywny link <span class="badge">ZAPASOWY</span>.</li>
        <li>Najlepiej trzymaj pliki <code>.pdf</code>/<code>.docx</code> w tym samym folderze co ta strona.</li>
      </ul>
    </div>

    <div class="card">
      <b>Legenda</b>
      <div class="row small" style="margin-top:8px"><span class="dot ok"></span> dzia≈Ça ‚Ä¢ <span class="dot bad" style="margin-left:12px"></span> brak pliku ‚Ä¢ <span class="dot try" style="margin-left:12px"></span> sprawd≈∫ wersjƒô ASCII</div>
    </div>
  </aside>
</div>

<script>
'use strict';

// ======= KONFIG ‚Äî Tu dopisz/zmie≈Ñ dokumenty =======
const DOCS = [
  // Umowy / PDF
  { title:'Umowa z wykonawcƒÖ (PDF)', file:'UMOWA Z WYKONAWCƒÑ arkon.pdf', cat:'Umowy' },
  { title:'Wz√≥r dyspozycji wyp≈Çaty zaliczki (PDF)', file:'za≈ÇƒÖcznik__14-06-2024.pdf', cat:'Umowy' },

  // O≈õwiadczenia / DOCX
  { title:'O≈õwiadczenie o dokonaniu zap≈Çaty (DOCX)', file:'O≈öWIADCZENIE O DOKONANIU ZAP≈ÅATY.docx', cat:'O≈õwiadczenia' },
  { title:'O≈õwiadczenie wsp√≥≈Çw≈Ça≈õciciela (DOCX)', file:'O≈öWIADCZENIE WSP√ì≈ÅW≈ÅA≈öCICIELA.docx', cat:'O≈õwiadczenia' },
  { title:'O≈õwiadczenie wsp√≥≈Çma≈Ç≈ºonka (DOCX)', file:'O≈öWIADCZENIE WSP√ì≈ÅMA≈Å≈ªONKA.docx', cat:'O≈õwiadczenia' },

  // Pe≈Çnomocnictwa
  { title:'Pe≈Çnomocnictwo (DOCX)', file:'PE≈ÅNOMOCNICTWO.docx', cat:'Pe≈Çnomocnictwa' }
];

// ======= POMOCNICZE =======
const $ = s => document.querySelector(s);
function normASCII(name){
  // Zamie≈Ñ PL znaki + spacje na ASCII/underscore
  const map = { 'ƒÖ':'a','ƒá':'c','ƒô':'e','≈Ç':'l','≈Ñ':'n','√≥':'o','≈õ':'s','≈º':'z','≈∫':'z',
                'ƒÑ':'A','ƒÜ':'C','ƒò':'E','≈Å':'L','≈É':'N','√ì':'O','≈ö':'S','≈ª':'Z','≈π':'Z' };
  return name.replace(/[ƒÖƒáƒô≈Ç≈Ñ√≥≈õ≈º≈∫ƒÑƒÜƒò≈Å≈É√ì≈ö≈ª≈π]/g, ch => map[ch] || ch)
             .replace(/\s+/g,'_');
}
// Sprawd≈∫ HEAD danego URL
async function check(url){
  try{
    const res = await fetch(url, { method:'HEAD', cache:'no-store' });
    return res.ok;
  }catch(e){ return false; }
}

// ======= RENDER =======
function render(list){
  const container = $('#list');
  container.innerHTML = '';
  const groups = [...new Set(list.map(d => d.cat || 'Inne'))];
  let found = 0;

  groups.forEach(cat => {
    const box = document.createElement('div');
    box.className = 'grp';
    const title = document.createElement('h3');
    title.innerHTML = `${cat} <span class="badge">${list.filter(d=> (d.cat||'Inne')===cat).length}</span>`;
    box.appendChild(title);

    const ul = document.createElement('div');
    ul.className = 'list';
    box.appendChild(ul);
    container.appendChild(box);

    list.filter(d => (d.cat||'Inne')===cat).forEach(d => {
      found++;
      const li = document.createElement('div');
      li.className = 'doc';
      li.innerHTML = `
        <div class="dot try" title="sprawdzam‚Ä¶"></div>
        <div>
          <div><b>${d.title}</b></div>
          <div class="path">plik: <code>${d.file}</code></div>
          <div class="path small" id="alt_${hash(d.file)}" hidden></div>
        </div>
        <div class="buttons">
          <a id="btn_${hash(d.file)}" href="#" download>‚§ì Pobierz</a>
          <button id="copy_${hash(d.file)}" type="button">Kopiuj link</button>
        </div>`;
      ul.appendChild(li);

      // Ustal linki (orygina≈Ç i alternatywa)
      const original = d.file;
      const ascii = normASCII(d.file);

      const a = li.querySelector('#btn_'+hash(d.file));
      const alt = li.querySelector('#alt_'+hash(d.file));
      const copyBtn = li.querySelector('#copy_'+hash(d.file));
      const dot = li.querySelector('.dot');

      // Zak≈Çadamy te same katalogi ‚Äî wzglƒôdne ≈õcie≈ºki
      const urlOriginal = encodeURI(original);
      const urlAscii = ascii;

      // Sprawdzanie HEAD
      (async () => {
        const okOrig = await check(urlOriginal);
        if (okOrig){
          a.href = urlOriginal; a.setAttribute('download','');
          copyBtn.onclick = () => copy(urlOriginal);
          dot.className = 'dot ok';
        }else{
          const okAscii = await check(urlAscii);
          if (okAscii){
            a.href = urlAscii; a.setAttribute('download','');
            copyBtn.onclick = () => copy(urlAscii);
            dot.className = 'dot ok';
            alt.hidden = false;
            alt.innerHTML = 'Alternatywny link (ASCII): <code>'+urlAscii+'</code>';
          }else{
            dot.className = 'dot bad';
            a.href = urlOriginal; // mimo wszystko podpinamy orygina≈Ç
            copyBtn.onclick = () => copy(urlOriginal);
            alt.hidden = false;
            alt.innerHTML = 'Nie znaleziono. Spr√≥buj zmieniƒá nazwƒô pliku na ASCII: <code>'+ascii+'</code>';
          }
        }
      })();
    });
  });
  $('#found').textContent = found;
}
function hash(s){
  // pro≈õciutki hash do id
  let h=0; for (let i=0;i<s.length;i++){ h=(h*31 + s.charCodeAt(i))|0; } return 'h'+Math.abs(h);
}
async function copy(text){
  try{ await navigator.clipboard.writeText(location.origin + location.pathname.replace(/[^\/]+$/,'') + text); alert('Skopiowano pe≈Çny link do schowka.'); }
  catch(e){ alert('Nie uda≈Ço siƒô skopiowaƒá.'); }
}

// ======= SZUKAJKA =======
$('#q').addEventListener('input', () => {
  const q = $('#q').value.toLowerCase().trim();
  const f = DOCS.filter(d => (d.title+' '+d.file+' '+(d.cat||'')).toLowerCase().includes(q));
  render(f);
});

// start
render(DOCS);
</script>
</body>
</html>
